<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Forever Valentine</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&family=Parisienne&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script type="module">
        import { Camera, Mesh, Plane, Program, Renderer, Texture, Transform } from 'https://cdn.skypack.dev/ogl';
        window.OGL = { Camera, Mesh, Plane, Program, Renderer, Texture, Transform };
    </script>
    
    <style>
        :root {
            --primary-pink: #ffafbd;
            --deep-rose: #ffc3a0;
            --heart-red: #ff4d6d;
            --blood-red: #8b0000;
            --dark-red: #4a0000;
            --glass-bg: rgba(255, 255, 255, 0.3);
            --card-bg: white;
            --text-color: #4a4a4a;
            --accent: #ff4d6d;
        }

        [data-theme="dark"] {
            --bg-gradient: linear-gradient(135deg, #2c3e50, #000000);
            --text-color: #f1f1f1;
            --glass-bg: rgba(0, 0, 0, 0.4);
            --card-bg: #1a1a1a;
        }

        body.accepted {
            background: linear-gradient(180deg, #8b0000, #4a0000) !important;
            color: white !important;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; transition: background 0.5s ease, color 0.5s ease; }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #ffafbd, #ffc3a0);
            background-attachment: fixed;
            overflow-x: hidden;
            text-align: center;
            color: var(--text-color);
        }

        /* --- NEW PROFILE PHOTO STYLE --- */
        .profile-container {
            width: 180px;
            height: 180px;
            margin: 20px auto;
            border-radius: 50%;
            border: 6px solid white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            overflow: hidden;
            background: #eee;
        }
        .profile-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* --- BOUNCE CARDS STYLES --- */
        .bounceCardsContainer {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 50px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .card {
            position: absolute;
            width: 150px;
            height: 200px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            overflow: hidden;
            cursor: pointer;
            border: 4px solid white;
        }
        .card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        #music-player {
            position: fixed; bottom: 20px; left: 20px; z-index: 10000;
            background: var(--glass-bg); padding: 10px 15px; border-radius: 50px;
            display: none; align-items: center; gap: 10px; backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }
        .pulse-heart { color: var(--heart-red); animation: pulse 1.2s infinite; font-size: 1.5rem; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1); } }

        .counter-container {
            margin-top: 20px; background: var(--glass-bg); padding: 15px 25px;
            border-radius: 20px; display: inline-block; backdrop-filter: blur(5px);
        }
        #days-count { font-size: 2.5rem; font-weight: 600; display: block; color: white; }
        .counter-label { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 2px; color: white; }

        .theme-switch {
            position: fixed; top: 20px; right: 20px; z-index: 10000;
            background: var(--glass-bg); padding: 10px; border-radius: 50px;
            cursor: pointer; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);
        }

        #lock-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #ffafbd, #ffc3a0);
            z-index: 12000; display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .lock-box { background: white; padding: 40px; border-radius: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.2); max-width: 400px; width: 90%; }
        #passInput { padding: 15px; border-radius: 15px; border: 2px solid var(--accent); font-size: 1.1rem; text-align: center; outline: none; margin-bottom: 20px; background: white; color: #333; width: 100%; }
        .unlock-btn { padding: 12px 40px; border-radius: 50px; border: none; background: var(--accent); color: white; font-weight: bold; cursor: pointer; }
        .hint-text { font-size: 0.85rem; color: #888; margin-top: 15px; font-style: italic; cursor: help; }

        .love-map {
            display: flex; align-items: center; justify-content: center; gap: 20px;
            margin: 30px auto 10px auto; color: white; font-weight: 600;
            background: rgba(255,255,255,0.2); padding: 20px 40px; border-radius: 50px;
            width: fit-content; backdrop-filter: blur(5px);
        }
        .map-line { width: 100px; height: 2px; background: repeating-linear-gradient(to right, white 0, white 5px, transparent 5px, transparent 10px); position: relative; }
        .traveling-heart { position: absolute; top: -10px; left: 0; animation: travel 3s linear infinite; }
        @keyframes travel { 0% { left: 0; opacity: 0; } 50% { opacity: 1; } 100% { left: 100%; opacity: 0; } }

        section { min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; position: relative; }
        h1 { font-family: 'Dancing Script', cursive; font-size: clamp(3rem, 10vw, 5rem); color: var(--accent); }
        .accepted h1 { color: white; }

        .btn-container { position: relative; height: 150px; width: 100%; display: flex; justify-content: center; align-items: center; gap: 20px; }
        #yesBtn { padding: 20px 60px; font-size: 1.5rem; border-radius: 50px; border: none; background: var(--heart-red); color: white; cursor: pointer; box-shadow: 0 10px 20px rgba(255,77,109,0.4); z-index: 100; }
        #noBtn { padding: 10px 25px; border-radius: 50px; border: none; background: var(--glass-bg); cursor: pointer; color: var(--text-color); position: relative; z-index: 100; }

        .giant-rose { position: fixed; top: -100px; pointer-events: none; z-index: 999; animation: fall linear forwards; }
        @keyframes fall { to { transform: translateY(115vh) rotate(720deg); } }

        #success-msg { 
            display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            background: white; padding: 40px; border-radius: 30px; z-index: 11000; 
            color: #444; width: 95%; max-width: 500px; box-shadow: 0 0 100px rgba(0,0,0,0.6); 
        }
        #secret-text { 
            display: none; font-family: 'Parisienne', cursive; font-size: 1.5rem; color: #5d4037; 
            border-bottom: 2px solid #f8d7da; margin-bottom: 15px; padding-bottom: 15px; 
            line-height: 1.4; text-align: left;
        }
        .heart-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
    </style>
</head>
<body data-theme="light">

    <div id="music-player">
        <span class="pulse-heart">‚ù§Ô∏è</span>
        <span style="font-size: 0.8rem; font-weight: bold;">Playing Your Song...</span>
    </div>

    <div class="theme-switch" id="themeToggle">
        <span id="themeIcon">üåô</span>
    </div>

    <div id="lock-screen">
        <div class="lock-box">
            <h2 style="font-family: 'Dancing Script'; margin-bottom: 15px; font-size: 2rem; color: var(--accent);">Our Secret Key ‚ù§Ô∏è</h2>
            <p style="margin-bottom: 20px; font-weight: 600; color: #555;">When did the stars finally decide that 'You' and 'I' should become 'Us'?</p>
            <input type="text" id="passInput" placeholder="Answer (e.g. Month Day)...">
            <button class="unlock-btn" onclick="checkPass()">Unlock My Heart</button>
            <p class="hint-text" onclick="alert('Confusing Hint: It\'s the day the summer starts to cry because it knows the unlucky number is coming...')">Need a hint?</p>
        </div>
    </div>

    <audio id="mySong" src="music.mp3" loop></audio>
    <div class="heart-bg" id="heartBg"></div>

    <section id="section-intro">
        <h1>Hi Love ‚ù§Ô∏è</h1>

        <div class="profile-container">
            <img src="main-photo.jpg.JPG" alt="Us" id="mainPhoto">
        </div>

        <div class="love-map">
            <span>Tuty</span> 
            <div class="map-line"><div class="traveling-heart">‚ù§Ô∏è</div></div>
            <span>Bhopal</span>
        </div>
        
        <div class="counter-container">
            <span id="days-count">1500</span>
            <span class="counter-label">Days Together</span>
        </div>
        <p id="reasonText" style="margin-top: 30px; font-style: italic;">Every heartbeat is for you...</p>
    </section>

    <section id="section-bounce-cards">
        <h2 style="font-family: 'Dancing Script'; font-size: 2.5rem; margin-bottom: 20px;">Our Little Moments...</h2>
        <div id="bounce-root"></div>
    </section>

    <section id="section-ask">
        <h1 id="questionTitle">Will you be my Valentine?</h1>
        <div class="btn-container">
            <button id="yesBtn">YES!</button>
            <button id="noBtn">No</button>
        </div>
        
        <div id="envelope-trigger" onclick="revealSecret()" style="margin-top: 40px; cursor: pointer; opacity: 0; pointer-events: none;">
            <span style="font-size: 5rem; filter: drop-shadow(0 0 15px white);">‚úâÔ∏è</span>
            <p style="color: white; font-weight: bold; font-size: 1.2rem;">Tap to read my letter</p>
        </div>
    </section>

    <div id="success-msg">
        <div id="secret-text">
            "To My Most Favorite Person,<br><br>
            From the moment our stars aligned on <b>September 13th</b>, my world has been brighter, warmer, and infinitely more beautiful. <br><br>
            They say distance is measured in miles, but I measure it in heartbeats‚Äîand every single one of mine belongs to you. You are the laugh that fills my silence and the peace in my busiest days. <br><br>
            Thank you for choosing me, for loving me, and for being the most incredible chapter of my life. No matter how many days pass or how many miles lie between our cities, it will always be you.<br><br>
            Happy Valentine's Day, my love. Forever isn't long enough."
        </div>
        <h2 id="success-title" style="font-family: 'Dancing Script'; font-size: 3rem; color: #8b0000;">I Knew It! ‚ù§Ô∏è</h2>
        <p id="success-sub">You've made me the happiest person alive.</p>
        <button onclick="document.getElementById('success-msg').style.display='none'" style="margin-top:20px; border:none; background:none; color:gray; cursor:pointer; font-weight:bold; font-size: 1rem;">Close & Explore</button>
    </div>

    <script type="module">
        // --- BOUNCE CARDS PHOTOS ---
        // REPLACE THESE WITH YOUR FILENAMES (e.g., '1.jpg', '2.jpg')
        const images = [
            'photo1.jpg.JPG',
            'photo2.jpg.JPG',
            'photo3.jpg.JPG',
            'photo4.jpg.JPG',
            'photo5.jpg.JPG'
        ];

        const transformStyles = [
            'rotate(10deg) translate(-170px)',
            'rotate(5deg) translate(-85px)',
            'rotate(-3deg)',
            'rotate(-10deg) translate(85px)',
            'rotate(2deg) translate(170px)'
        ];

        function initBounceCards() {
            const root = document.getElementById('bounce-root');
            const container = document.createElement('div');
            container.className = 'bounceCardsContainer';
            
            images.forEach((src, idx) => {
                const card = document.createElement('div');
                card.className = `card card-${idx}`;
                card.style.transform = transformStyles[idx];
                card.innerHTML = `<img src="${src}" alt="memory">`;
                
                card.addEventListener('mouseenter', () => pushSiblings(idx));
                card.addEventListener('mouseleave', resetSiblings);
                
                container.appendChild(card);
            });
            
            root.appendChild(container);

            gsap.fromTo('.card', 
                { scale: 0 }, 
                { scale: 1, stagger: 0.06, ease: 'elastic.out(1, 0.8)', delay: 0.5 }
            );
        }

        const getNoRotationTransform = transformStr => {
            return transformStr.replace(/rotate\([\s\S]*?\)/, 'rotate(0deg)') || 'rotate(0deg)';
        };

        const getPushedTransform = (baseTransform, offsetX) => {
            const translateRegex = /translate\(([-0-9.]+)px\)/;
            const match = baseTransform.match(translateRegex);
            if (match) {
                return baseTransform.replace(translateRegex, `translate(${parseFloat(match[1]) + offsetX}px)`);
            }
            return `${baseTransform} translate(${offsetX}px)`;
        };

        const pushSiblings = hoveredIdx => {
            images.forEach((_, i) => {
                const target = document.querySelector(`.card-${i}`);
                const baseTransform = transformStyles[i] || 'none';
                if (i === hoveredIdx) {
                    gsap.to(target, { transform: getNoRotationTransform(baseTransform), duration: 0.4, ease: 'back.out(1.4)', overwrite: 'auto' });
                } else {
                    const offsetX = i < hoveredIdx ? -160 : 160;
                    gsap.to(target, { 
                        transform: getPushedTransform(baseTransform, offsetX), 
                        duration: 0.4, ease: 'back.out(1.4)', 
                        delay: Math.abs(hoveredIdx - i) * 0.05, overwrite: 'auto' 
                    });
                }
            });
        };

        const resetSiblings = () => {
            images.forEach((_, i) => {
                gsap.to(`.card-${i}`, { transform: transformStyles[i], duration: 0.4, ease: 'back.out(1.4)', overwrite: 'auto' });
            });
        };

        // Initialize Everything
        window.addEventListener('load', () => {
            initBounceCards();
            updateCounter();
        });

        // Theme Toggle
        document.getElementById('themeToggle').addEventListener('click', () => {
            const body = document.body;
            const isLight = body.getAttribute('data-theme') === 'light';
            body.setAttribute('data-theme', isLight ? 'dark' : 'light');
            document.getElementById('themeIcon').innerText = isLight ? '‚òÄÔ∏è' : 'üåô';
        });

        // Love Counter (Calculated to reach 1500 on Feb 7, 2026)
        const startDate = new Date("2021-12-29"); 
        function updateCounter() {
            const now = new Date();
            const diffTime = Math.abs(now - startDate);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            document.getElementById('days-count').innerText = diffDays;
        }

        // Passcheck
        window.checkPass = function() {
            const pass = document.getElementById('passInput').value.toLowerCase().trim();
            if(pass === "sep 13" || pass === "september 13") {
                const song = document.getElementById('mySong');
                song.play().then(() => { song.pause(); song.currentTime = 0; }).catch(() => {});
                document.getElementById('lock-screen').style.display = 'none';
            } else { 
                alert("Incorrect! Think harder... the hint might help or hurt! ‚ù§Ô∏è"); 
            }
        }

        // Acceptance Logic
        let accepted = false;
        document.getElementById('yesBtn').addEventListener('click', () => {
            accepted = true;
            document.body.classList.add('accepted');
            document.getElementById('success-msg').style.display = 'block';
            document.getElementById('music-player').style.display = 'flex';
            document.getElementById('mySong').play();
            document.getElementById('envelope-trigger').style.opacity = '1';
            document.getElementById('envelope-trigger').style.pointerEvents = 'auto';
            document.getElementById('noBtn').style.display = 'none';
            
            setInterval(() => {
                const rose = document.createElement('div');
                rose.innerHTML = 'üåπ'; rose.className = 'giant-rose';
                rose.style.left = Math.random() * 100 + 'vw';
                rose.style.fontSize = (Math.random() * 50 + 30) + 'px';
                rose.style.animationDuration = (Math.random() * 2 + 2) + 's';
                document.body.appendChild(rose);
                setTimeout(() => rose.remove(), 4000);
            }, 80);
            
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        });

        // NO BUTTON WORKAROUND
        const noBtn = document.getElementById('noBtn');
        noBtn.addEventListener('mouseover', () => {
            if(accepted) return;
            noBtn.style.position = 'fixed';
            noBtn.style.left = Math.random() * (window.innerWidth - 150) + 'px';
            noBtn.style.top = Math.random() * (window.innerHeight - 50) + 'px';
        });

        window.revealSecret = function() {
            document.getElementById('secret-text').style.display = 'block';
            document.getElementById('success-msg').style.display = 'block';
        }

        // Floating Hearts
        setInterval(() => {
            const heart = document.createElement('div');
            heart.innerHTML = '‚ù§Ô∏è'; heart.style.position = 'fixed';
            heart.style.left = Math.random() * 100 + 'vw'; heart.style.top = '100vh';
            heart.style.opacity = Math.random(); heart.style.zIndex = '-1';
            heart.style.transition = 'transform 6s linear';
            document.getElementById('heartBg').appendChild(heart);
            setTimeout(() => heart.style.transform = 'translateY(-110vh)', 50);
            setTimeout(() => heart.remove(), 7000);
        }, 400);
    </script>
</body>
</html>
